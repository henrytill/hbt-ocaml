(cram
 (deps %{bin:hbt})
 (package hbt))

(mdx
 (deps
  (package hbt-core))
 (package hbt-core)
 (libraries unix))

(test
 (name collection_test)
 (modules collection_test)
 (package hbt-core)
 (libraries alcotest hbt-core uri))

; Unified test approach

(test
 (name hbt_test)
 (modules hbt_test test_data)
 (package hbt-core)
 (libraries alcotest hbt-core yaml uri)
 (deps
  (glob_files data/markdown/*.input.*)
  (glob_files data/markdown/*.expected.*)
  (glob_files data/html/*.input.*)
  (glob_files data/html/*.expected.*)
  (glob_files data/pinboard/*.input.*)
  (glob_files data/pinboard/*.expected.*))
 (action
  (setenv
   TZ
   UTC
   (run %{test}))))
